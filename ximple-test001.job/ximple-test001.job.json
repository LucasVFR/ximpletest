{
  "name" : "ximple-test001.job",
  "jobMode" : "VISUAL",
  "description" : "",
  "role" : "arn:aws:iam::442042553432:role/glue-job-role",
  "executionProperty" : {
    "maxConcurrentRuns" : 1
  },
  "command" : {
    "name" : "glueetl",
    "scriptLocation" : "s3://aws-glue-assets-442042553432-us-east-1/scripts/.py",
    "pythonVersion" : "3"
  },
  "defaultArguments" : {
    "--enable-metrics" : "true",
    "--enable-spark-ui" : "true",
    "--spark-event-logs-path" : "s3://aws-glue-assets-442042553432-us-east-1/sparkHistoryLogs/",
    "--enable-job-insights" : "true",
    "--enable-observability-metrics" : "true",
    "--enable-glue-datacatalog" : "true",
    "--enable-continuous-cloudwatch-log" : "true",
    "--job-bookmark-option" : "job-bookmark-disable",
    "--job-language" : "python",
    "--TempDir" : "s3://aws-glue-assets-442042553432-us-east-1/temporary/"
  },
  "maxRetries" : 0,
  "allocatedCapacity" : 10,
  "timeout" : 2880,
  "maxCapacity" : 10.0,
  "glueVersion" : "4.0",
  "numberOfWorkers" : 10,
  "workerType" : "G.1X",
  "executionClass" : "STANDARD",
  "codeGenConfigurationNodes" : "{\"node-1730494308839\":{\"EvaluateDataQualityMultiFrame\":{\"AdditionalDataSources\":{},\"AdditionalOptions\":{\"observations.scope\":\"ALL\",\"performanceTuning.caching\":\"CACHE_NOTHING\"},\"Inputs\":[\"node-1730493417762\"],\"Name\":\"step 1 - schema check\",\"PublishingOptions\":{\"CloudWatchMetricsEnabled\":true,\"ResultsPublishingEnabled\":true,\"ResultsS3Prefix\":\"\"},\"Ruleset\":\"\\n\\nRules = [\\n    ColumnExists \\\"loan_id\\\",\\n    ColumnExists \\\"application_date\\\",\\n    ColumnExists \\\"loan_amount\\\",\\n    ColumnExists \\\"interest_rate\\\",\\n    ColumnExists \\\"term_months\\\",\\n    ColumnExists \\\"customer_income\\\",\\n    ColumnExists \\\"customer_credit_score\\\",\\n    ColumnExists \\\"loan_status\\\",\\n    ColumnExists \\\"employment_length\\\",\\n    ColumnDataType  \\\"loan_id\\\" = \\\"INTEGER\\\",\\n    ColumnDataType  \\\"application_date\\\" = \\\"DATE\\\",\\n    ColumnDataType  \\\"loan_amount\\\" = \\\"FLOAT\\\",\\n    ColumnDataType  \\\"interest_rate\\\" = \\\"FLOAT\\\",\\n    ColumnDataType  \\\"term_months\\\" = \\\"INTEGER\\\",\\n    ColumnDataType  \\\"customer_income\\\" = \\\"DOUBLE\\\",\\n    ColumnDataType \\\"customer_credit_score\\\" = \\\"INTEGER\\\",\\n    ColumnCount = 9,\\n    IsPrimaryKey \\\"loan_id\\\",\\n    ColumnValues \\\"loan_status\\\" in [\\\"Approved\\\",\\\"Defaulted\\\",\\\"Pending\\\",\\\"Rejected\\\"],\\n    ColumnValues \\\"employment_length\\\" in [\\\"<1 year\\\",\\\"1-3 years\\\",\\\"3-5 years\\\",\\\"5-10 years\\\", \\\">10 years\\\"]\\n    \\n]\",\"StopJobOnFailureOptions\":{}}},\"node-1730666392226\":{\"SparkSQL\":{\"Inputs\":[\"node-1730666370401\"],\"Name\":\"step 2 - normalize by Z-score\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"loan_id\",\"Type\":\"bigint\"},{\"Name\":\"application_date\",\"Type\":\"date\"},{\"Name\":\"loan_amount\",\"Type\":\"float\"},{\"Name\":\"interest_rate\",\"Type\":\"float\"},{\"Name\":\"term_months\",\"Type\":\"int\"},{\"Name\":\"loan_status\",\"Type\":\"string\"},{\"Name\":\"customer_income\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"customer_credit_score\",\"Type\":\"int\"},{\"Name\":\"employment_length\",\"Type\":\"string\"},{\"Name\":\"Z_score\",\"Type\":\"double\"}]}],\"SqlAliases\":[{\"Alias\":\"myDataSource\",\"From\":\"node-1730666370401\"}],\"SqlQuery\":\"select *,(term_months - mean(term_months) over()) / std(term_months) over () as Z_score \\r\\nfrom myDataSource\"}},\"node-1730678357279\":{\"S3GlueParquetTarget\":{\"AutoDataQuality\":{\"IsEnabled\":false},\"Compression\":\"snappy\",\"Inputs\":[\"node-1730672636821\"],\"Name\":\"Amazon S3\",\"PartitionKeys\":[],\"Path\":\"s3://ximple-challenge/transformed-output/\",\"SchemaChangePolicy\":{\"Database\":\"ximple-challenge-db\",\"EnableUpdateCatalog\":true,\"Table\":\"final_transformed_normalized\",\"UpdateBehavior\":\"UPDATE_IN_DATABASE\"}}},\"node-1730663890798\":{\"EvaluateDataQualityMultiFrame\":{\"AdditionalDataSources\":{},\"AdditionalOptions\":{\"observations.scope\":\"ALL\",\"performanceTuning.caching\":\"CACHE_NOTHING\"},\"Inputs\":[\"node-1730663768034\"],\"Name\":\"step 1 - missing values check\",\"PublishingOptions\":{\"CloudWatchMetricsEnabled\":true,\"ResultsPublishingEnabled\":true,\"ResultsS3Prefix\":\"\"},\"Ruleset\":\"# Example rules: Completeness \\\"colA\\\" between 0.4 and 0.8, ColumnCount > 10\\nRules = [Completeness \\\"loan_amount\\\" = 1,  \\nCompleteness \\\"interest_rate\\\" = 1,\\nCompleteness \\\"loan_id\\\" = 1,\\nCompleteness \\\"application_date\\\" = 1,\\nCompleteness \\\"term_months\\\" = 1,\\nCompleteness \\\"customer_income\\\" = 1,\\nCompleteness \\\"customer_credit_score\\\" = 1\\n]\",\"StopJobOnFailureOptions\":{}}},\"node-1730672636821\":{\"SparkSQL\":{\"Inputs\":[\"node-1730666392226\"],\"Name\":\"Step 3 - transform\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"loan_id\",\"Type\":\"bigint\"},{\"Name\":\"application_date\",\"Type\":\"date\"},{\"Name\":\"loan_amount\",\"Type\":\"float\"},{\"Name\":\"interest_rate\",\"Type\":\"float\"},{\"Name\":\"term_months\",\"Type\":\"int\"},{\"Name\":\"loan_status\",\"Type\":\"string\"},{\"Name\":\"customer_income\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"customer_credit_score\",\"Type\":\"int\"},{\"Name\":\"employment_length\",\"Type\":\"string\"},{\"Name\":\"Z_score\",\"Type\":\"double\"},{\"Name\":\"ccs_transformed\",\"Type\":\"double\"}]}],\"SqlAliases\":[{\"Alias\":\"myDataSource\",\"From\":\"node-1730666392226\"}],\"SqlQuery\":\"select *,\\r\\n(POWER(customer_credit_score, 3) + EXP(customer_credit_score)) as ccs_transformed\\r\\nfrom myDataSource\"}},\"node-1730666370401\":{\"SelectFromCollection\":{\"Index\":0,\"Inputs\":[\"node-1730663890798\"],\"Name\":\"originalData\"}},\"node-1730667657631\":{\"Filter\":{\"Filters\":[{\"Negated\":false,\"Operation\":\"REGEX\",\"Values\":[{\"Type\":\"CONSTANT\",\"Value\":[\"Pending\"]},{\"Type\":\"COLUMNEXTRACTED\",\"Value\":[\"loan_status\"]}]}],\"Inputs\":[\"node-1730666392226\"],\"LogicalOperator\":\"AND\",\"Name\":\"step 2 - Filter\"}},\"node-1730673041915\":{\"SelectFromCollection\":{\"Index\":0,\"Inputs\":[\"node-1730494308839\"],\"Name\":\"ruleOutcomes\"}},\"node-1730674131160\":{\"Aggregate\":{\"Aggs\":[{\"AggFunc\":\"countDistinct\",\"Column\":[\"loan_id\"]}],\"Groups\":[[\"loan_status\"]],\"Inputs\":[\"node-1730672636821\"],\"Name\":\"step 3 - Aggregate\"}},\"node-1730672408536\":{\"Aggregate\":{\"Aggs\":[{\"AggFunc\":\"count\",\"Column\":[\"loan_id\"]}],\"Groups\":[[\"application_date\"]],\"Inputs\":[\"node-1730667657631\"],\"Name\":\"step 2 - group date\"}},\"node-1730494333223\":{\"EvaluateDataQualityMultiFrame\":{\"AdditionalDataSources\":{},\"AdditionalOptions\":{\"observations.scope\":\"ALL\",\"performanceTuning.caching\":\"CACHE_NOTHING\"},\"Inputs\":[\"node-1730493417762\"],\"Name\":\"step 1 - erroneos or anomalous data check\",\"PublishingOptions\":{\"CloudWatchMetricsEnabled\":true,\"ResultsPublishingEnabled\":true,\"ResultsS3Prefix\":\"\"},\"Ruleset\":\"# Example rules: Completeness \\\"colA\\\" between 0.4 and 0.8, ColumnCount > 10\\n\\nAnalyzers = [\\nColumnValues \\\"loan_amount\\\",\\nColumnValues \\\"interest_rate\\\"\\n]\",\"StopJobOnFailureOptions\":{}}},\"node-1730671555326\":{\"SelectFromCollection\":{\"Index\":0,\"Inputs\":[\"node-1730663890798\"],\"Name\":\"ruleOutcomes\"}},\"node-1730674462093\":{\"S3GlueParquetTarget\":{\"AutoDataQuality\":{\"IsEnabled\":false},\"Compression\":\"snappy\",\"Inputs\":[\"node-1730663768034\"],\"Name\":\"load to S3 - decd_converted_ds\",\"PartitionKeys\":[],\"Path\":\"s3://ximple-challenge\",\"SchemaChangePolicy\":{\"Database\":\"ximple-challenge-db\",\"EnableUpdateCatalog\":true,\"Table\":\"og_transformed\",\"UpdateBehavior\":\"UPDATE_IN_DATABASE\"}}},\"node-1730663768034\":{\"ApplyMapping\":{\"Inputs\":[\"node-1730493417762\"],\"Mapping\":[{\"Dropped\":false,\"FromPath\":[\"loan_id\"],\"FromType\":\"string\",\"ToKey\":\"loan_id\",\"ToType\":\"bigint\"},{\"Dropped\":false,\"FromPath\":[\"application_date\"],\"FromType\":\"string\",\"ToKey\":\"application_date\",\"ToType\":\"date\"},{\"Dropped\":false,\"FromPath\":[\"loan_amount\"],\"FromType\":\"string\",\"ToKey\":\"loan_amount\",\"ToType\":\"float\"},{\"Dropped\":false,\"FromPath\":[\"interest_rate\"],\"FromType\":\"string\",\"ToKey\":\"interest_rate\",\"ToType\":\"float\"},{\"Dropped\":false,\"FromPath\":[\"term_months\"],\"FromType\":\"string\",\"ToKey\":\"term_months\",\"ToType\":\"int\"},{\"Dropped\":false,\"FromPath\":[\"loan_status\"],\"FromType\":\"string\",\"ToKey\":\"loan_status\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"customer_income\"],\"FromType\":\"string\",\"ToKey\":\"customer_income\",\"ToType\":\"decimal\"},{\"Dropped\":false,\"FromPath\":[\"customer_credit_score\"],\"FromType\":\"string\",\"ToKey\":\"customer_credit_score\",\"ToType\":\"int\"},{\"Dropped\":false,\"FromPath\":[\"employment_length\"],\"FromType\":\"string\",\"ToKey\":\"employment_length\",\"ToType\":\"string\"}],\"Name\":\"Change Schema\"}},\"node-1730493417762\":{\"S3CsvSource\":{\"AdditionalOptions\":{\"EnableSamplePath\":false,\"SamplePath\":\"s3://ximple-test/data_engineering_challenge_dataset.csv\"},\"Escaper\":\"\",\"Exclusions\":[],\"Name\":\"Amazon S3\",\"OptimizePerformance\":false,\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"loan_id\",\"Type\":\"string\"},{\"Name\":\"application_date\",\"Type\":\"string\"},{\"Name\":\"loan_amount\",\"Type\":\"string\"},{\"Name\":\"interest_rate\",\"Type\":\"string\"},{\"Name\":\"term_months\",\"Type\":\"string\"},{\"Name\":\"loan_status\",\"Type\":\"string\"},{\"Name\":\"customer_income\",\"Type\":\"string\"},{\"Name\":\"customer_credit_score\",\"Type\":\"string\"},{\"Name\":\"employment_length\",\"Type\":\"string\"}]}],\"Paths\":[\"s3://ximple-test/data_engineering_challenge_dataset.csv\"],\"QuoteChar\":\"quote\",\"Separator\":\"comma\",\"WithHeader\":true}},\"node-1730671486513\":{\"SelectFromCollection\":{\"Index\":0,\"Inputs\":[\"node-1730494333223\"],\"Name\":\"ruleOutcomes\"}}}",
  "sourceControlDetails" : {
    "provider" : "GITHUB",
    "repository" : "ximpletest",
    "branch" : "develop",
    "folder" : "ximple-test001.job"
  }
}